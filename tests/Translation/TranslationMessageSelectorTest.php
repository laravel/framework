<?php

namespace Illuminate\Tests\Translation;

use PHPUnit\Framework\TestCase;
use Illuminate\Translation\MessageSelector;

class TranslationMessageSelectorTest extends TestCase
{
    /**
     * @dataProvider chooseTestData
     */
    public function testChoose($expected, $id, $number)
    {
        $selector = new MessageSelector;

        $this->assertEquals($expected, $selector->choose($id, $number, 'en'));
    }

    public function chooseTestData()
    {
        return [
            ['first', 'first', 1],
            ['first', 'first', 10],
            ['second', 'first|second', 0],
            ['first', 'first|second', 1],
            ['second', 'first|second', '1.0'],
            ['second', 'first|second', 1.5],
            ['second', 'first|second', 9],
            ['second', 'first|second', 10],

            ['first', '{0}  first|{1}second', 0],
            ['first', '{1}first|{2}second', 1],
            ['second', '{1}first|{2}second', 2],
            ['first', '{2}first|{1}second', 2],
            ['second', '{9}first|{10}second', 0],
            ['first', '{9}first|{10}second', 1],
            ['', '{0}|{1}second', 0],
            ['', '{0}first|{1}', 1],
            ['first', '{1.3}first|{2.3}second', 1.3],
            ['second', '{1.3}first|{2.3}second', 2.3],
            ['first
            line', '{1}first
            line|{2}second', 1],
            ["first \n
            line", "{1}first \n
            line|{2}second", 1],

            ['first', '{0}  first|[1,9]second', 0],
            ['second', '{0}first|[1,9]second', 1],
            ['second', '{0}first|[1,9]second', 10],
            ['first', '{0}first|[2,9]second', 1],
            ['second', '[4,*]first|[1,3]second', 1],
            ['first', '[4,*]first|[1,3]second', 100],
            ['second', '[1,5]first|[6,10]second', 7],
            ['first', '[*,4]first|[5,*]second', 1],
            ['second', '[5,*]first|[*,4]second', 1],
            ['second', '[5,*]first|[*,4]second', 0],

            ['first', '{0}first|[1,3]second|[4,*]third', 0],
            ['second', '{0}first|[1,3]second|[4,*]third', 1],
            ['third', '{0}first|[1,3]second|[4,*]third', 9],

            ['first', '{0}  first | { 1 } second', 0],
            ['first', '[4,*]first | [1,3]second', 100],
        ];
    }

    /**
     * @dataProvider pluralIndexProvider
     */
    public function testPluralIndex($expected, $locale, $number)
    {
        $selector = new MessageSelector;

        $this->assertEquals($expected, $selector->getPluralIndex($locale, $number));
    }

    public function pluralIndexProvider()
    {
        return [
            [0, 'am', 0],
            [0, 'am', 0.04],
            [0, 'am', 1],
            [1, 'am', 1.1],
            [1, 'am', 2],
            [1, 'am', 18],

            [0, 'ff', 0],
            [0, 'ff', 1],
            [0, 'ff', 1.9],
            [1, 'ff', 2],
            [1, 'ff', 2.7],
            [1, 'ff', 10.01],
            [0, 'pt_BR', 0],
            [0, 'pt_BR', 1],
            [0, 'pt_BR', 1.99],
            [1, 'pt_BR', 2],
            [1, 'pt_BR', 5],
            [1, 'pt_BR', 10],

            [1, 'en', 0],
            [1, 'en', 0.33],
            [0, 'en', 1],
            [1, 'en', '1.0'],
            [1, 'en', 1.64],
            [1, 'en', 100],
            [1, 'pt_PT', 0],
            [1, 'pt_PT', 0.33],
            [0, 'pt_PT', 1],
            [1, 'pt_PT', '1.0'],
            [1, 'pt_PT', 1.64],
            [1, 'pt_PT', 100],

            [0, 'si', 0],
            [0, 'si', 1],
            [0, 'si', '1.0'],
            [1, 'si', 1.1],
            [1, 'si', 2],
            [1, 'si', 31.1],

            [0, 'ak', 0],
            [0, 'ak', 1],
            [0, 'ak', '1.0'],
            [1, 'ak', 1.001],
            [1, 'ak', 2],
            [1, 'ak', 17],

            [0, 'tzm', 0],
            [0, 'tzm', '0.0'],
            [1, 'tzm', 0.1],
            [0, 'tzm', 1],
            [1, 'tzm', 1.5],
            [1, 'tzm', 10],
            [0, 'tzm', 11],
            [1, 'tzm', 11.5],
            [0, 'tzm', 12],
            [0, 'tzm', 99],
            [1, 'tzm', 100],

            [1, 'es', 0],
            [0, 'es', 1],
            [0, 'es', '1.0'],
            [0, 'es', '1.00'],
            [1, 'es', 1.01],
            [1, 'es', 2],

            [1, 'da', 0],
            [0, 'da', 0.1],
            [0, 'da', 1],
            [0, 'da', 1.1],
            [0, 'da', 1.9],
            [1, 'da', 2],
            [1, 'da', 2.1],

            [1, 'is', 0],
            [0, 'is', 0.1],
            [0, 'is', 1],
            [0, 'is', '1.0'],
            [0, 'is', 1.75],
            [0, 'is', 10.1],
            [1, 'is', 2],
            [0, 'is', 21],
            [1, 'is', 22],
            [0, 'is', 31],
            [0, 'is', 100.1],
            [0, 'is', 101],

            [1, 'mk', 0],
            [0, 'mk', 0.1],
            [0, 'mk', 1],
            [0, 'mk', 1.1],
            [1, 'mk', 2],
            [0, 'mk', 81],
            [1, 'mk', 100],
            [0, 'mk', 100.1],
            [0, 'mk', 101],
            [1, 'mk', 1000],
            [0, 'mk', 1001],

            [0, 'ceb', 0],
            [0, 'ceb', 1],
            [1, 'ceb', 1.6],
            [0, 'ceb', 3],
            [1, 'ceb', 4],
            [0, 'ceb', 5],
            [1, 'ceb', 6],

            [0, 'lv', 0],
            [1, 'lv', 1],
            [2, 'lv', 1.2],
            [2, 'lv', 2],
            [1, 'lv', 10.1],
            [2, 'lv', 10.2],
            [0, 'lv', 11],
            [0, 'lv', '11.0'],
            [1, 'lv', 21],
            [0, 'lv', 100],
            [1, 'lv', 100.1],
            [2, 'lv', 100.2],

            [0, 'lag', 0],
            [0, 'lag', '0.0'],
            [1, 'lag', 0.1],
            [1, 'lag', 1],
            [1, 'lag', 1.5],
            [2, 'lag', 2],
            [2, 'lag', '2.0'],
            [2, 'lag', 2.5],
            [2, 'lag', 10],

            [0, 'ksh', 0],
            [0, 'ksh', '0.0'],
            [1, 'ksh', 1],
            [1, 'ksh', '1.0'],
            [2, 'ksh', 1.5],
            [2, 'ksh', 2],

            [2, 'iu', 0],
            [0, 'iu', 1],
            [0, 'iu', '1.0'],
            [2, 'iu', 1.1],
            [1, 'iu', 2],
            [1, 'iu', '2.0'],

            [0, 'shi', 0],
            [0, 'shi', 0.5],
            [0, 'shi', 1],
            [2, 'shi', 1.1],
            [1, 'shi', 2],
            [2, 'shi', 2.1],
            [1, 'shi', '5.0'],
            [1, 'shi', 10],
            [2, 'shi', 10.1],
            [2, 'shi', 11],

            [1, 'mo', 0],
            [0, 'mo', 1],
            [1, 'mo', '1.0'],
            [1, 'mo', 2],
            [2, 'mo', 100],
            [1, 'mo', '100.0'],
            [1, 'mo', 102],

            [2, 'bs', 0],
            [2, 'bs', '0.0'],
            [0, 'bs', 0.1],
            [1, 'bs', 0.3],
            [0, 'bs', 1],
            [2, 'bs', '1.0'],
            [0, 'bs', 1.1],
            [1, 'bs', 2],
            [2, 'bs', 5],
            [0, 'bs', 21],
            [1, 'bs', 62],
            [2, 'bs', 1000],
            [1, 'bs', 1000.2],
            [0, 'bs', 1001],

            [3, 'gd', 0],
            [0, 'gd', 1],
            [0, 'gd', '1.000'],
            [3, 'gd', 1.1],
            [0, 'gd', 11],
            [1, 'gd', 2],
            [1, 'gd', '2.000'],
            [1, 'gd', 12],
            [2, 'gd', 3],
            [2, 'gd', 4],
            [2, 'gd', '4.0'],
            [2, 'gd', 13],
            [3, 'gd', 20],
            [3, 'gd', 1000],

            [3, 'sl', 0],
            [2, 'sl', '0.0'],
            [0, 'sl', 1],
            [2, 'sl', '1.0'],
            [1, 'sl', 2],
            [2, 'sl', 3],
            [2, 'sl', 4],
            [3, 'sl', 5],
            [3, 'sl', 100],
            [2, 'sl', '100.0'],
            [0, 'sl', 101],
            [2, 'sl', 103],
            [1, 'sl', 302],
            [0, 'sl', 401],
            [1, 'sl', 402],
            [2, 'sl', 404],

            [3, 'dsb', 0],
            [0, 'dsb', 0.1],
            [1, 'dsb', 0.2],
            [2, 'dsb', 0.3],
            [3, 'dsb', 0.5],
            [0, 'dsb', 1],
            [0, 'dsb', 1.1],
            [1, 'dsb', 1.2],
            [2, 'dsb', 1.3],
            [1, 'dsb', 2],
            [2, 'dsb', 3],
            [2, 'dsb', 4],
            [3, 'dsb', 5],
            [3, 'dsb', '10.0'],
            [3, 'dsb', 11],
            [0, 'dsb', 6.1],
            [1, 'dsb', 202],
            [0, 'dsb', 301],
            [2, 'dsb', 304],
            [3, 'dsb', '100.0'],

            [3, 'he', 0],
            [3, 'he', '0.0'],
            [0, 'he', 1],
            [3, 'he', 1.5],
            [1, 'he', 2],
            [2, 'he', 20],
            [2, 'he', 80],
            [2, 'he', 100],
            [3, 'he', '100.0'],
            [2, 'he', 1000],
            [3, 'he', '1000.0'],

            [3, 'cs', 0],
            [2, 'cs', '0.0'],
            [0, 'cs', 1],
            [2, 'cs', 1.5],
            [1, 'cs', 2],
            [1, 'cs', 4],
            [3, 'cs', 5],
            [3, 'cs', 10],
            [2, 'cs', '10.0'],
            [3, 'cs', 1000],

            [2, 'pl', 0],
            [3, 'pl', '0.0'],
            [0, 'pl', 1],
            [3, 'pl', 1.5],
            [1, 'pl', 2],
            [1, 'pl', 4],
            [2, 'pl', 5],
            [1, 'pl', 42],
            [2, 'pl', 1000],
            [3, 'pl', '1000.0'],
            [1, 'pl', 1002],

            [2, 'be', 0],
            [2, 'be', '0.0'],
            [3, 'be', 0.1],
            [0, 'be', 1],
            [0, 'be', '1.0'],
            [3, 'be', 1.1],
            [1, 'be', 2],
            [1, 'be', 3],
            [1, 'be', '4.0'],
            [2, 'be', '5.0'],
            [0, 'be', 21],
            [0, 'be', 61],
            [0, 'be', '61.0'],
            [2, 'be', '100.0'],
            [3, 'be', 100.1],
            [0, 'be', 101],
            [1, 'be', '102.0'],

            [3, 'lt', 0],
            [3, 'lt', '0.0'],
            [2, 'lt', 0.1],
            [0, 'lt', 1],
            [0, 'lt', '1.0'],
            [2, 'lt', 1.1],
            [1, 'lt', 2],
            [1, 'lt', 5],
            [1, 'lt', '9.0'],
            [3, 'lt', 10],
            [0, 'lt', 41],
            [0, 'lt', '41.0'],
            [2, 'lt', 41.1],
            [3, 'lt', 1000],
            [3, 'lt', '1000.0'],

            [1, 'mt', 0],
            [1, 'mt', '0.0'],
            [3, 'mt', 0.1],
            [0, 'mt', 1],
            [0, 'mt', '1.0'],
            [0, 'mt', '1.00'],
            [3, 'mt', 1.5],
            [1, 'mt', 2],
            [1, 'mt', 4],
            [1, 'mt', '8.0'],
            [3, 'mt', '100.0'],
            [2, 'mt', 111],
            [2, 'mt', '118.0'],

            [2, 'ru', 0],
            [3, 'ru', '0.0'],
            [0, 'ru', 1],
            [3, 'ru', 1.5],
            [1, 'ru', 3],
            [1, 'ru', 4],
            [2, 'ru', 5],
            [2, 'ru', 9],
            [0, 'ru', 31],
            [1, 'ru', 32],
            [2, 'ru', 1000],
            [3, 'ru', '1000.0'],
            [0, 'ru', 1001],

            [4, 'br', 0],
            [4, 'br', '0.0'],
            [0, 'br', 1],
            [4, 'br', '1.1'],
            [1, 'br', 2],
            [2, 'br', 3],
            [0, 'br', '1.0'],
            [4, 'br', 20],
            [0, 'br', 21],
            [2, 'br', 23],
            [0, 'br', 31],
            [0, 'br', '31.0'],
            [1, 'br', 32],
            [1, 'br', '32.0'],
            [2, 'br', '103.0'],
            [3, 'br', 1000000],
            [3, 'br', '1000000.0'],
            [3, 'br', '1000000.00'],

            [4, 'ga', 0],
            [4, 'ga', '0.0'],
            [0, 'ga', 1],
            [0, 'ga', '1.0'],
            [4, 'ga', 1.5],
            [1, 'ga', 2],
            [1, 'ga', '2.0'],
            [2, 'ga', 3],
            [2, 'ga', '6.0'],
            [2, 'ga', '6.000'],
            [3, 'ga', 8],
            [3, 'ga', '8.0'],
            [3, 'ga', 10],
            [3, 'ga', '10.00'],
            [4, 'ga', 10.1],
            [4, 'ga', '100.0'],

            [2, 'gv', 0],
            [3, 'gv', '0.0'],
            [0, 'gv', 1],
            [3, 'gv', 1.2],
            [1, 'gv', 2],
            [4, 'gv', 3],
            [0, 'gv', 11],
            [4, 'gv', 13],
            [4, 'gv', 19],
            [2, 'gv', 40],
            [0, 'gv', 41],
            [1, 'gv', 72],
            [2, 'gv', 100],
            [3, 'gv', '100.0'],
            [0, 'gv', 101],
            [1, 'gv', 102],
            [4, 'gv', 103],

            [0, 'ar', 0],
            [0, 'ar', '0.00'],
            [5, 'ar', 0.1],
            [1, 'ar', 1],
            [1, 'ar', '1.0'],
            [5, 'ar', 1.5],
            [2, 'ar', 2],
            [3, 'ar', 3],
            [3, 'ar', '5.0'],
            [3, 'ar', 7],
            [3, 'ar', 10],
            [4, 'ar', 11],
            [4, 'ar', 25],
            [5, 'ar', 100],
            [3, 'ar', '103.0'],
            [4, 'ar', 1011],
            [4, 'ar', '1011.0'],

            [0, 'cy', 0],
            [0, 'cy', '0.0'],
            [0, 'cy', '0.000'],
            [1, 'cy', 1],
            [1, 'cy', '1.0'],
            [2, 'cy', 2],
            [2, 'cy', '2.0000'],
            [3, 'cy', 3],
            [3, 'cy', '3.0'],
            [5, 'cy', 4],
            [5, 'cy', 5],
            [4, 'cy', 6],
            [4, 'cy', '6.000'],
            [5, 'cy', 100],
            [5, 'cy', '1000.0'],

            [0, 'kw', 0],
            [0, 'kw', '0.0000'],
            [1, 'kw', 1],
            [1, 'kw', '1.0'],
            [2, 'kw', 2],
            [3, 'kw', 3],
            [5, 'kw', 4],
            [5, 'kw', '10.0'],
            [5, 'kw', 19],
            [4, 'kw', 21],
            [3, 'kw', 23],
            [4, 'kw', 41],
            [2, 'kw', '42.0'],
            [4, 'kw', '81.0'],
            [5, 'kw', '100.0'],
            [3, 'kw', '123.0'],
            [2, 'kw', 142],
        ];
    }
}
